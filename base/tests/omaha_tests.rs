mod helper;

use race_poker_base::game::PokerGame;
use race_poker_base::omaha::OmahaVariant;
#[allow(unused)]
use race_api::prelude::*;
#[allow(unused)]
use race_test::prelude::*;

#[test]
fn test_1() -> anyhow::Result<()> {
    let effect_bs = [0, 0, 0, 0, 0, 45, 169, 194, 19, 154, 1, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 13, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 99, 113, 1, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 100, 106, 2, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 104, 113, 3, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 104, 50, 4, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 100, 52, 5, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 100, 97, 6, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 104, 55, 7, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 104, 107, 8, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 100, 51, 9, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 115, 54, 10, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 115, 51, 11, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 115, 56, 12, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 115, 107, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 101, 2, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 194, 235, 11, 0, 0, 0, 0, 64, 66, 15, 0, 0, 0, 0, 0, 128, 132, 30, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 0, 1, 5, 5, 0, 0, 0, 0, 0, 0, 0, 0, 5, 0, 0, 0, 2, 0, 0, 0, 100, 51, 2, 0, 0, 0, 115, 54, 2, 0, 0, 0, 115, 51, 2, 0, 0, 0, 115, 56, 2, 0, 0, 0, 115, 107, 2, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 5, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, 0, 0, 0, 0, 0, 7, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 128, 132, 30, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 128, 132, 30, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 192, 158, 230, 5, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, 0, 3, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 64, 26, 200, 5, 0, 0, 0, 0, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, 0, 2, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 2, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 61, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 5, 0, 0, 0, 2, 0, 0, 0, 100, 51, 2, 0, 0, 0, 115, 54, 2, 0, 0, 0, 115, 51, 2, 0, 0, 0, 115, 56, 2, 0, 0, 0, 115, 107, 2, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 64, 66, 15, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 1, 128, 132, 30, 0, 0, 0, 0, 0, 0, 192, 198, 45, 0, 0, 0, 0, 0, 2, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 2, 64, 66, 15, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 1, 0, 9, 61, 0, 0, 0, 0, 0, 2, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 1, 2, 0, 0, 0, 0, 0, 0, 0, 1, 0, 9, 61, 0, 0, 0, 0, 0, 2, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 1, 2, 0, 0, 0, 0, 0, 0, 0, 1, 0, 9, 61, 0, 0, 0, 0, 0, 2, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 1, 2, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
    let event_bs = [16, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0];

    let mut effect = Effect::try_from_slice(&effect_bs)?;
    let event = Event::try_from_slice(&event_bs)?;

    println!("Event: {:?}", event);

    let mut handler: PokerGame<OmahaVariant> = effect.__handler_state();

    println!("before: {:?}", handler);

    let r = handler.handle_event(&mut effect, event)?;

    println!("Result: {:?}", r);

    handler = effect.__handler_state();

    println!("after: {:?}", handler);

    println!("Error: {:?}", effect.__take_error());

    Ok(())
}
