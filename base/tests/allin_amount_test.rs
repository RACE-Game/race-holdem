use race_api::prelude::*;
use borsh::de::BorshDeserialize;
use race_poker_base::game::*;
use race_poker_base::holdem::HoldemVariant;
use race_poker_base::essential::GameEvent;

#[test]
fn test_raise_allin() {
    let st_bs = [32, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 194, 235, 11, 0, 0, 0, 0, 64, 66, 15, 0, 0, 0, 0, 0, 128, 132, 30, 0, 0 , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 192, 252, 155, 1, 0, 0, 0, 0, 0, 30, 0, 1, 2, 2, 192, 252, 155, 1, 0, 0, 0, 0, 3, 0, 0, 0, 2, 0 , 0, 0, 100, 97, 2, 0, 0, 0, 100, 50, 2, 0, 0, 0, 100, 116, 2, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 , 1, 0, 0, 0, 0, 0, 0, 0, 5, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 5, 0, 0, 0, 0, 0, 0, 0, 192, 252, 155, 1, 0, 0, 0, 0, 2, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 128, 141, 91, 0, 0, 0, 0, 0, 5, 0, 0, 0, 0, 0, 0 , 0, 64, 138, 247, 1, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 192, 210, 31, 2, 0, 0, 0 , 0, 1, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 5, 0, 0, 0, 0, 0, 0, 0, 5, 0, 0, 0, 0, 0, 0, 0, 32, 171, 249, 8, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 0, 2, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 5, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 2, 0, 0, 0, 4, 0, 0, 0, 0, 0 , 0, 0, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 27, 183, 0, 0, 0, 0, 0, 1, 4, 0, 0, 0, 0, 0, 0, 0, 1, 49, 42, 42, 215, 154, 1, 0, 0 , 201, 100, 42, 215, 154, 1, 0, 0, 1, 249, 217, 42, 215, 154, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 3, 0, 0, 0, 2, 0, 0, 0, 100, 97, 2, 0, 0, 0, 100, 50, 2, 0, 0, 0, 100, 116, 2, 0, 0, 0, 5, 0, 0, 0, 0, 0, 0, 0, 0, 64, 66, 15, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 1, 128, 132, 30, 0, 0, 0, 0, 0, 0, 192, 198, 45, 0, 0, 0, 0, 0, 2, 0, 0, 0, 5, 0, 0, 0, 0, 0, 0, 0, 4, 128, 141, 91, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 2, 0, 9, 61, 0, 0, 0, 0, 0, 0, 0, 27, 183, 0, 0, 0, 0, 0, 2, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 1, 5, 0, 0, 0, 0, 0, 0, 0, 0, 192, 252, 155, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] ;

    let mut handler = PokerGame::<HoldemVariant>::try_from_slice(&st_bs).unwrap();

    println!("Handler: {:?}", handler);

    let e_bs = [4, 192, 210, 31, 2, 0, 0, 0, 0];

    let event = GameEvent::try_from_slice(&e_bs).unwrap();

    println!("Event: {:?}", event);

    let mut effect = Effect::default();

    handler.handle_custom_event(&mut effect, event, 4).unwrap();
}
